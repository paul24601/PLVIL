<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User View - Library Seat Viewer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/chairs-user.css">    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <!-- Bootstrap Icons CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- For High-Resolution Icons -->
    <link rel="icon" href="assets/plvil-logo.svg" type="image/svg+xml">
    <style>
        
        body {
            background-image: url(assets/img/books.png);
            background-position: center;
            /* Center the image */
            background-attachment: fixed;
            background-size: cover;
            font-family: 'Roboto', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif
        }

        .navbar {
            padding: 0;
        }

        .header-line {
            height: 5px;
            width: 100%;
            margin: auto;
            padding: 0;
        }

        .blue-line {
            background-color: #007bff;
        }

        .black-line {
            background-color: #000;
        }

        .white-line {
            background-color: #e2e2e2;
        }

        .custom-navbar {
            background-color: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            /* Optional: Adds a blur effect to the background */
        }

        .scroll-box {
            max-height: 500px;
            overflow-y: auto;
        }

        .offcanvas {
            background-color: rgba(255, 255, 255, 0.7);
            /* White with 70% opacity */
            backdrop-filter: blur(10px);
            /* Optional: Adds a blur effect to the background */
        }

        .minimal-btn {
            background: rgba(255, 255, 255, 0.8); /* Semi-transparent white */
            border: none;
            padding: 5px 10px;
            border-radius: 40%;
            color: #000;
            opacity: 0.8; /* Reduced opacity */
            font-size: 1.2em;
            transition: opacity 0.3s;
        }
        .minimal-btn:hover {
            opacity: 1.0; /* Slightly increase opacity on hover */
        }
        /* Initial state */
        .custom-navbar {
            background-color: rgba(255, 255, 255, .9);
            /* Translucent background */
            transition: background-color 0.3s ease-in-out;
            /* Smooth transition */
            backdrop-filter: blur(10px);
        }

        /* Opaque state */
        .custom-navbar.scrolled {
            background-color: rgba(255, 255, 255, .5);
            /* Fully opaque background */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Navbar link hover effect */
        .navbar-nav .nav-link {
            transition: transform 0.3s ease;
            /* Smooth transition for scaling */
            padding: 10px 15px;
            /* Ensure spacing around the links */
        }

        .navbar-nav .nav-link:hover {
            transform: scale(1.1);
            /* Slightly increase size on hover */
            font-weight: bold;
            /* Make active link bold */
        }

        /* Active link: Make the active link bold */
        .navbar-nav .nav-link.active {
            font-weight: bold;
            /* Make active link bold */
        }
        
        .custom-popover .popover-body {
            max-width: 200px; /* Adjust this width as needed */
            padding: 10px; /* Optional: increase padding */
            font-size: 1.1em; /* Optional: increase font size */
            background-color: rgba(255, 255, 255, .5);
            border-radius: 5px;
            border: 0;
        }

        /* Chevron when section is expanded */
        a:not(.collapsed) .bi-chevron-down {
            transform: rotate(0deg);
            transition: transform 0.3s ease-in-out;
            /* Add transition */
        }

        /* Chevron when section is collapsed */
        a.collapsed .bi-chevron-down {
            transform: rotate(90deg);
            transition: transform 0.3s ease-in-out;
            /* Add transition */
        }
    </style>
</head>

<body>
    <!--Header-->
    <div class="container-fluid row header-line">
        <div class="col-4 col-lg-3 black-line"></div>
        <div class="col-4 col-lg-2 white-line"></div>
        <div class="col-4 col-lg-7 blue-line"></div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-md sticky-top custom-navbar">
        <div class="container-fluid px-2 px-md-5 py-2">
            <a href="index.html" class="navbar-brand">
                <span class="fw-bolder text-dark fs-4 d-md-none d-block PLVIL-title">PLVIL</span>
                <span class="fw-bolder text-dark fs-4 d-none d-md-block PLVIL-title">PLV: Interactive Library</span>
            </a>
            <!-- Toggler Button with Font Awesome Icon -->
            <button class="navbar-toggler d-md-none border-0" type="button" data-bs-toggle="popover" 
            data-bs-placement="bottom" data-bs-html="true" aria-expanded="false" 
            aria-label="Toggle Navigation">
                <i class="fas fa-bars fa-lg"></i> <!-- Modern hamburger icon -->
            </button>
            <!-- nav -->
            <div class="collapse navbar-collapse justify-content-end align-center d-none d-md-flex" id="main-nav">
                <ul class="navbar-nav">
                    <li class="class-item">
                        <a href="index.html" class="me-4 fs-6 text-dark fw-medium nav-link active">Home</a>
                    </li>
                    <li class="class-item">
                        <a href="#" class="me-4 fs-6 text-dark fw-medium nav-link" data-bs-toggle="modal"
                            data-bs-target="#arModal">AR Scan</a>
                    </li>
                    <li class="class-item">
                        <a href="chairs-user.html"
                            class="me-4 fs-6 text-dark fw-medium nav-link">Chairs</a>
                    </li>
                    <li class="class-item">
                        <a href="about.html" class="me-2 fs-6 text-dark fw-medium nav-link">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- AR Scan Modal -->
    <div class="modal fade" id="arModal" tabindex="-1" aria-labelledby="arModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="arModalLabel">Augmented Reality (AR) Consent Form</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body scroll-box p-3">
                    <p>Dear Users,</p>
                    <p>We are excited to introduce the Augmented Reality (AR) feature as part of the PLVIL: Development of Library Management System with Book Locator and Augmented Reality Assisted Book Viewer for Pamantasan ng Lungsod ng Valenzuela (PLV) University Library. Before you proceed to use this feature, we would like to seek your consent regarding the collection and usage of certain data as required by law.</p>
                    <h3>Explanation of Augmented Reality (AR) Feature:</h3>
                    <p>The AR feature allows users to experience immersive and interactive views of selected library resources through their mobile devices. By accessing this feature, you will be able to visualize additional information, such as book details and related multimedia content, overlaid onto physical objects within the library environment.</p>
                    <h3>Consent for Camera and Speaker Access:</h3>
                    <p>In order to provide you with the AR experience, the PLVIL system requires access to your device's camera and speakers. This access is necessary to enable the AR technology to overlay digital content onto the physical environment and to deliver audiovisual feedback accordingly.</p>
                    <h3>Data Privacy Compliance:</h3>
                    <p>We are committed to protecting your privacy and ensuring compliance with the Data Privacy Act of the Philippines (Republic Act No. 10173) and its implementing rules and regulations. By providing your consent to access your device's camera and speakers for the AR feature, you acknowledge and agree to the following:</p>
                    <ol>
                        <li><strong>Purpose of Data Collection:</strong> The data collected (i.e., images captured by the camera and audio output through the speakers) will be used solely for the purpose of delivering the AR experience within the PLVIL system.</li>
                        <li><strong>Storage and Security:</strong> Any data collected will be stored securely and will not be shared with third parties without your explicit consent, except as required by law.</li>
                        <li><strong>User Control:</strong> You have the right to withdraw your consent at any time by disabling the AR feature in the PLVIL system settings. However, please note that disabling this feature will prevent you from accessing the AR content.</li>
                        <li><strong>Data Retention:</strong> Data collected for the AR feature will be retained only for as long as necessary to fulfill the purposes for which it was collected or as required by applicable laws and regulations.</li>
                    </ol>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="acceptBtn">Accept</button>
                    <button type="button" class="btn btn-secondary" id="declineBtn" data-bs-dismiss="modal">Decline</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Offcanvas Menu -->
    <div class="offcanvas offcanvas-end d-md-none" tabindex="-1" id="offcanvasMenu"
        aria-labelledby="offcanvasMenuLabel">
        <div class="offcanvas-header">
            <h5 id="offcanvasMenuLabel">Menu</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="navbar-nav">
                <li class="class-item">
                    <a href="index.html" class="fs-6 text-dark fw-bold nav-link active">Home</a>
                </li>
                <li class="class-item">
                    <a href="#" class="fs-6 text-dark fw-bold nav-link" data-bs-toggle="modal" data-bs-target="#arModal">AR Scan</a>
                </li>
                <li class="class-item">
                    <a href="Admin/chairs-user.html" class="fs-6 text-dark fw-bold nav-link">Chairs</a>
                </li>
                <li class="class-item">
                    <a href="about.html" class="fs-6 text-dark fw-bold nav-link active">About</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- main section -->
    <main class="container rounded shadow" style="background-color: rgba(255, 255, 255, .5); backdrop-filter: blur(10px);">
        <div class="container mt-4 p-3">
            <h2>Library Floor Plan</h2>
            <!-- Image Container with Single Bottom Button -->
            <div class="position-relative text-center mb-3" style="display: inline-block; max-width: 100%;">
                <!-- Image Display -->
                <img id="floorPlanImage" src="../assets/floor-plan/ground_floor.png?timestamp=<?php echo time(); ?>" alt="Library Floor Plan" style="max-width: 100%; height: auto; position: relative;">
                
                <!-- Toggle Button (Overlay, Bottom Center) -->
                <button id="toggleButton" class="minimal-btn position-absolute" style="bottom: 10px; left: 50%; transform: translateX(-50%);" onclick="toggleImage()">&#9650;</button>
            </div>
        
            <!-- Tables and Chairs Section -->
            <h3>
                <a class="text-decoration-none text-dark" data-bs-toggle="collapse" href="#collapseTablesAndChairs"
                role="button" aria-expanded="false" aria-controls="collapseTablesAndChairs">
                Tables and Chairs
                <i class="bi bi-chevron-down float-end"></i> <!-- Chevron icon -->
                </a>
            </h3>
            <div id="collapseTablesAndChairs" class="container-fluid collapse show">
                <div id="tables-chairs-container" class="container-fluid"></div>
            </div>

                        
            <!-- Add a horizontal line to separate sections -->
            <hr class="my-4"> <!-- Adds some margin space around the horizontal line -->
        
            <!-- Computer Seats Section -->
            <h3>
                <a class="text-decoration-none text-dark" data-bs-toggle="collapse" href="#collapseComputerSeats"
                role="button" aria-expanded="false" aria-controls="collapseComputerSeats">
                Computer Seats
                <i class="bi bi-chevron-down float-end"></i> <!-- Chevron icon -->
                </a>
            </h3>
            <div id="collapseComputerSeats" class="container-fluid collapse show">
                <div id="computer-seats-container" class="container-fluid"></div>
            </div>
                        
            <!-- Add a horizontal line to separate sections -->
            <hr class="my-4"> <!-- Adds some margin space around the horizontal line -->
        
            <!-- Graduate Study Seats Section -->
            <h3>
                <a class="text-decoration-none text-dark" data-bs-toggle="collapse" href="#collapseGraduatestudySeats"
                role="button" aria-expanded="false" aria-controls="collapseGraduatestudySeats">
                Graduate Study Seats
                <i class="bi bi-chevron-down float-end"></i> <!-- Chevron icon -->
                </a>
            </h3>
            <div id="collapseGraduatestudySeats"  class="container-fluid collapse show">
                <div id="graduate-seats-container" class="container-fluid"></div>
            </div>

          </div>
    </main>


    <!-- Footer -->
    <footer class="text-center text-lg-start bg-light text-muted mt-5 pt-1">
        <!-- Section: Links -->
        <section class="container text-center text-md-start mt-5">
            <div class="row mt-3">
                <!-- About -->
                <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mx-4">
                    <h6 class="text-uppercase fw-bold mb-4">
                        <i class="fas fa-book me-3"></i>PLV: Interactive Library
                    </h6>
                    <p>
                        The PLVIL project brings the library closer to students through interactive tools like AR,
                        making knowledge more accessible.
                    </p>
                </div>

                <!-- Quick Links -->
                <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
                    <h6 class="text-uppercase fw-bold mb-4">Quick Links</h6>
                    <p><a href="index.html" class="text-reset">Home</a></p>
                    <p><a href="about.html" class="text-reset">About</a></p>
                    <p><a href="search_results.php?search_type=keyword&query=+" class="text-reset">Browse Books</a></p>
                    <p><a href="#" class="text-reset" data-bs-toggle="modal" data-bs-target="#arModal">AR Scan</a></p>
                </div>

                <!-- Contact -->
                <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
                    <h6 class="text-uppercase fw-bold mb-4">Contact</h6>
                    <p><i class="fas fa-home me-3"></i>Maysan, Valenzuela, Philippines</p>
                    <!-- Gmail Link (using mailto for email link) -->
                    <p>
                        <a href="mailto:plvlibrarymain@gmail.com" class="me-4 text-reset text-decoration-none">
                            <i class="fas fa-envelope me-3"></i>plvlibrarymain@gmail.com
                        </a>
                    </p>
                    <p><i class="fas fa-phone me-3"></i>8352-700 Loc. 134, 135</p>
                    <!-- Facebook Link -->
                    <p>
                        <a href="https://www.facebook.com/profile.php?id=100064626706651" class="me-4 text-reset text-decoration-none">
                            <i class="fab fa-facebook-f me-3"></i>Pamantasan ng Lungsod ng Valenzuela University Library
                        </a>
                    </p>
                </div>
            </div>
        </section>

        <!-- Copyright -->
        <div class="text-center p-4" style="background-color: rgba(0, 0, 0, 0.05);">
            © 2024 Copyright:
            <a class="text-reset fw-bold" href="#">PLV: Interactive Library</a>
        </div>
    </footer>
    <script>
        //modal
        document.addEventListener('DOMContentLoaded', function () {
            // Handle Accept button click
            document.getElementById('acceptBtn').addEventListener('click', function () {
                // Show confirmation message
                alert('Thank you for your cooperation and participation in the PLVIL project. If you have any questions or concerns regarding this consent form or the AR feature, please do not hesitate to contact us.');

                // Redirect to AR scan page after a short delay
                setTimeout(function () {
                    window.location.href = 'AR/ar-scan.html';
                }, 1000); // Delay of 1 second
            });

            // Handle Decline button click (close modal by default)
            document.getElementById('declineBtn').addEventListener('click', function () {
                $('#arModal').modal('hide');
            });
        });
    </script>

    <!-- popover navbar -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navContent = `
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link text-dark">
                            <i class="fas fa-home me-2"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" id="arScanButton" class="nav-link text-dark">
                            <i class="fas fa-camera me-2"></i>AR Scan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="chairs-user.html" class="nav-link text-dark">
                            <i class="fas fa-chair me-2"></i>Chairs
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="about.html" class="nav-link text-dark">
                            <i class="fas fa-info-circle me-2"></i>About
                        </a>
                    </li>
                </ul>
            `;

            const popoverTrigger = document.querySelector('[data-bs-toggle="popover"]');
            const popover = new bootstrap.Popover(popoverTrigger, {
                content: navContent,
                html: true,
                container: 'body',
                customClass: 'custom-popover'
            });

            // Track popover visibility
            let popoverVisible = false;

            popoverTrigger.addEventListener('click', function () {
                popoverVisible = !popoverVisible; // Toggle visibility flag
            });

            document.addEventListener('click', function (e) {
                // Hide popover on next click outside of the popoverTrigger if it is visible
                if (popoverVisible && !popoverTrigger.contains(e.target)) {
                    popover.hide();
                    popoverVisible = false; // Reset visibility flag
                }
            });

            // Event listener to open the modal
            document.addEventListener('click', function (e) {
                if (e.target && e.target.id === 'arScanButton') {
                    const arModal = new bootstrap.Modal(document.getElementById('arModal'));
                    arModal.show();
                }
            });
        });

    </script>


    <script>
        document.addEventListener("DOMContentLoaded", loadChairs);
    
        function loadChairs() {
            fetch("admin-dashboard/chairs.php?action=load")
                .then(response => response.json())
                .then(data => {
                    const sections = {
                        'tables-chairs': document.getElementById("tables-chairs-container"),
                        'computer-seats': document.getElementById("computer-seats-container"),
                        'graduate-seats': document.getElementById("graduate-seats-container"),
                    };

                    const rowLimits = {
                        'tables-chairs': 8,
                        'computer-seats': 9,
                        'graduate-seats': 10,
                    };

                    const icons = {
                        'tables-chairs': 'assets/icons/table.png', // Icon for tables and chairs
                        'computer-seats': 'assets/icons/computer.png', // Icon for computer seats
                        'graduate-seats': 'assets/icons/graduate.png', // Icon for graduate study seats
                    };

                    // Clear all sections
                    Object.values(sections).forEach(section => section.innerHTML = "");

                    // Populate each section with chairs
                    Object.keys(sections).forEach((sectionKey) => {
                        const sectionChairs = data.filter(chair => chair.section === sectionKey);
                        let tableNumber = 1;
                        const rowLimit = rowLimits[sectionKey]; // Get the specific row limit for the section
                        const iconPath = icons[sectionKey]; // Get the specific icon for the section

                        for (let i = 0; i < sectionChairs.length; i += rowLimit) {
                            const tableRow = document.createElement("div");
                            tableRow.classList.add("d-flex", "align-items-center", "mb-4");

                            // Add table icon with number
                            const tableIcon = document.createElement("div");
                            tableIcon.classList.add("me-3", "text-center");
                            tableIcon.innerHTML = `<img src="${iconPath}" alt="Table Icon" style="width: 40px;"> <br> Table ${tableNumber++}`;
                            tableRow.appendChild(tableIcon);

                            // Add chairs to the row
                            const chairsRow = document.createElement("div");
                            chairsRow.classList.add("row", `row-cols-${rowLimit}`, "g-2", "flex-grow-1");

                            sectionChairs.slice(i, i + rowLimit).forEach(chair => {
                                const button = document.createElement("button");
                                button.classList.add("btn", "m-1", "col");
                                button.textContent = `Chair ${chair.seat_number}`;
                                button.classList.add(chair.status === "occupied" ? "btn-danger" : "btn-success");
                                button.onclick = () => toggleChair(chair.id);
                                chairsRow.appendChild(button);
                            });

                            tableRow.appendChild(chairsRow);
                            sections[sectionKey].appendChild(tableRow);
                        }
                    });
                });
        }
        let lastUpdateTime = null;

        function checkForChanges() {
            fetch("admin-dashboard/chairs.php?action=check_changes")
                .then(response => response.json())
                .then(data => {
                    if (lastUpdateTime !== data.last_updated) {
                        lastUpdateTime = data.last_updated;
                        loadChairs(); // Refresh the chair layout
                    }
                })
                .catch(error => console.error("Error checking for updates:", error));
        }

        // Start checking for changes every 5 seconds
        setInterval(checkForChanges, 5000);

    </script>
    
    <!-- custom navbar -->
    <script>
        // Add a scroll event listener
        window.addEventListener('scroll', function () {
            // Select the navbar
            var navbar = document.querySelector('.custom-navbar');

            // Add or remove the 'scrolled' class based on scroll position
            if (window.scrollY > 10) { // Adjust the value '50' as needed
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
    </script>

    <script>
        // Paths to the floor plan images
        let currentImageIndex = 0; // Start with the first image (index 0)

// Dynamically generate image paths with a timestamp to prevent caching
const images = [
    `../assets/floor-plan/ground_floor.png?timestamp=${new Date().getTime()}`,
    `../assets/floor-plan/second_floor.png?timestamp=${new Date().getTime()}`
];

// Function to update the displayed image and button icon
function updateImage() {
    document.getElementById("floorPlanImage").src = images[currentImageIndex];
    
    // Update button icon: Down (&#9660;) when on the first image, Up (&#9650;) on the second
    const toggleButton = document.getElementById("toggleButton");
    toggleButton.innerHTML = currentImageIndex === 0 ? "&#9650;" : "&#9660;";
}

// Toggle between the first and second image
function toggleImage() {
    currentImageIndex = currentImageIndex === 0 ? 1 : 0;
    updateImage();
}
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

</html>